openapi: 3.0.3
info:
  title: DIGIT Config Service API
  description: Config Service for runtime behavior, templates, and notification policies.
  version: 0.1.0
servers:
  - url: https://{host}/configs
    variables:
      host:
        default: config.example.org
security:
  - bearerAuth: []
paths:
  /v1/_search:
    post:
      tags:
        - Config
      summary: Search configs
      operationId: searchConfigs
      requestBody:
        required: true
        content:
          "*/*":
            schema:
              $ref: "#/components/schemas/ConfigSearchRequest"
      responses:
        "200":
          description: Config search results
          content:
            "*/*":
              schema:
                $ref: "#/components/schemas/ConfigResponse"
        "400":
          description: Invalid input.
          content:
            "*/*":
              schema:
                $ref: "https://raw.githubusercontent.com/egovernments/DIGIT-OSS/master/core-services/docs/common-contract_v1-1.yml#/components/schemas/ErrorRes"
        "401":
          description: Unauthorized.
          content:
            "*/*":
              schema:
                $ref: "https://raw.githubusercontent.com/egovernments/DIGIT-OSS/master/core-services/docs/common-contract_v1-1.yml#/components/schemas/ErrorRes"
  /v1/_create:
    post:
      tags:
        - Config
      summary: Create a config
      operationId: createConfig
      requestBody:
        required: true
        content:
          "*/*":
            schema:
              $ref: "#/components/schemas/ConfigRequest"
      responses:
        "201":
          description: Config created
          content:
            "*/*":
              schema:
                $ref: "#/components/schemas/ConfigResponse"
        "400":
          description: Invalid input.
          content:
            "*/*":
              schema:
                $ref: "https://raw.githubusercontent.com/egovernments/DIGIT-OSS/master/core-services/docs/common-contract_v1-1.yml#/components/schemas/ErrorRes"
        "401":
          description: Unauthorized.
          content:
            "*/*":
              schema:
                $ref: "https://raw.githubusercontent.com/egovernments/DIGIT-OSS/master/core-services/docs/common-contract_v1-1.yml#/components/schemas/ErrorRes"
  /v1/_update:
    post:
      tags:
        - Config
      summary: Update a config
      operationId: updateConfig
      requestBody:
        required: true
        content:
          "*/*":
            schema:
              $ref: "#/components/schemas/ConfigRequest"
      responses:
        "200":
          description: Config updated
          content:
            "*/*":
              schema:
                $ref: "#/components/schemas/ConfigResponse"
        "400":
          description: Invalid input.
          content:
            "*/*":
              schema:
                $ref: "https://raw.githubusercontent.com/egovernments/DIGIT-OSS/master/core-services/docs/common-contract_v1-1.yml#/components/schemas/ErrorRes"
        "401":
          description: Unauthorized.
          content:
            "*/*":
              schema:
                $ref: "https://raw.githubusercontent.com/egovernments/DIGIT-OSS/master/core-services/docs/common-contract_v1-1.yml#/components/schemas/ErrorRes"
  /v1/_activate:
    post:
      tags:
        - Config
      summary: Activate a config set
      operationId: activateConfigSet
      requestBody:
        required: true
        content:
          "*/*":
            schema:
              $ref: "#/components/schemas/ConfigSetActivateRequest"
      responses:
        "200":
          description: Config set activated
          content:
            "*/*":
              schema:
                $ref: "#/components/schemas/ConfigSetActivateResponse"
        "400":
          description: Invalid input.
          content:
            "*/*":
              schema:
                $ref: "https://raw.githubusercontent.com/egovernments/DIGIT-OSS/master/core-services/docs/common-contract_v1-1.yml#/components/schemas/ErrorRes"
        "401":
          description: Unauthorized.
          content:
            "*/*":
              schema:
                $ref: "https://raw.githubusercontent.com/egovernments/DIGIT-OSS/master/core-services/docs/common-contract_v1-1.yml#/components/schemas/ErrorRes"
  /v1/template/_preview:
    post:
      tags:
        - Config
      summary: Render a template preview
      operationId: previewTemplate
      requestBody:
        required: true
        content:
          "*/*":
            schema:
              $ref: "#/components/schemas/TemplatePreviewRequest"
      responses:
        "200":
          description: Template preview response
          content:
            "*/*":
              schema:
                $ref: "#/components/schemas/TemplatePreviewResponse"
        "400":
          description: Invalid input.
          content:
            "*/*":
              schema:
                $ref: "https://raw.githubusercontent.com/egovernments/DIGIT-OSS/master/core-services/docs/common-contract_v1-1.yml#/components/schemas/ErrorRes"
        "401":
          description: Unauthorized.
          content:
            "*/*":
              schema:
                $ref: "https://raw.githubusercontent.com/egovernments/DIGIT-OSS/master/core-services/docs/common-contract_v1-1.yml#/components/schemas/ErrorRes"
components:
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
  schemas:
    ConfigRequest:
      type: object
      description: Request wrapper containing metadata and a config payload.
      properties:
        requestInfo:
          $ref: "https://raw.githubusercontent.com/egovernments/egov-services/master/docs/common/contracts/v1-0-0.yml#/definitions/RequestInfo"
        config:
          $ref: "#/components/schemas/Config"
    ConfigResponse:
      type: object
      description: Response wrapper containing configs and pagination.
      properties:
        responseInfo:
          $ref: "https://raw.githubusercontent.com/egovernments/egov-services/master/docs/common/contracts/v1-0-0.yml#/definitions/ResponseInfo"
        configs:
          type: array
          description: List of matching config records.
          items:
            $ref: "#/components/schemas/Config"
        pagination:
          $ref: "https://raw.githubusercontent.com/egovernments/DIGIT-OSS/master/core-services/docs/common-contract_v1-1.yml#/components/schemas/Pagination"
    ConfigSearchRequest:
      type: object
      description: Request wrapper for search criteria and metadata.
      properties:
        requestInfo:
          $ref: "https://raw.githubusercontent.com/egovernments/egov-services/master/docs/common/contracts/v1-0-0.yml#/definitions/RequestInfo"
        criteria:
          $ref: "#/components/schemas/ConfigSearchCriteria"
    ConfigSearchCriteria:
      type: object
      description: Search criteria for configs.
      properties:
        tenantId:
          type: string
          description: Tenant identifier for which configs are searched.
          minLength: 2
          maxLength: 64
        namespace:
          type: string
          description: Logical namespace for configs.
          minLength: 2
          maxLength: 128
        configName:
          type: string
          description: Human-friendly config name.
          minLength: 2
          maxLength: 128
        configCode:
          type: string
          description: Stable config code identifier.
          minLength: 2
          maxLength: 128
        environment:
          type: string
          description: Deployment environment identifier.
          minLength: 2
          maxLength: 32
        status:
          type: string
          description: Config lifecycle status.
          minLength: 2
          maxLength: 32
        version:
          type: string
          description: Version label for the config.
          minLength: 1
          maxLength: 64
        includeContent:
          type: boolean
          description: When true, return full content payload.
          default: true
        limit:
          type: integer
          description: Maximum number of records to return.
          minimum: 0
        offset:
          type: integer
          description: Number of records to skip before returning results.
          minimum: 0
    ConfigSetActivateRequest:
      type: object
      description: Request to activate a config set.
      properties:
        requestInfo:
          $ref: "https://raw.githubusercontent.com/egovernments/egov-services/master/docs/common/contracts/v1-0-0.yml#/definitions/RequestInfo"
        tenantId:
          type: string
          description: Tenant identifier for the activation.
          minLength: 2
          maxLength: 64
        configSetId:
          type: string
          description: Identifier of the config set to activate.
          minLength: 1
          maxLength: 64
    ConfigSetActivateResponse:
      type: object
      description: Activation result for a config set.
      properties:
        responseInfo:
          $ref: "https://raw.githubusercontent.com/egovernments/egov-services/master/docs/common/contracts/v1-0-0.yml#/definitions/ResponseInfo"
        configSetId:
          type: string
          description: Identifier of the activated config set.
          minLength: 1
          maxLength: 64
        status:
          type: string
          description: Status after activation.
          minLength: 2
          maxLength: 32
    TemplatePreviewRequest:
      type: object
      description: Request to render a template preview.
      properties:
        requestInfo:
          $ref: "https://raw.githubusercontent.com/egovernments/egov-services/master/docs/common/contracts/v1-0-0.yml#/definitions/RequestInfo"
        tenantId:
          type: string
          description: Tenant identifier for template resolution.
          minLength: 2
          maxLength: 64
        template:
          $ref: "#/components/schemas/TemplateRef"
        locale:
          type: string
          description: Locale to render the template in.
          example: en_IN
          minLength: 2
          maxLength: 16
        data:
          type: object
          description: Variables for template rendering.
          additionalProperties: true
    TemplatePreviewResponse:
      type: object
      description: Response containing rendered template text.
      properties:
        responseInfo:
          $ref: "https://raw.githubusercontent.com/egovernments/egov-services/master/docs/common/contracts/v1-0-0.yml#/definitions/ResponseInfo"
        rendered:
          type: string
          description: Rendered output for the given template and data.
          minLength: 0
          maxLength: 4096
        locale:
          type: string
          description: Locale used for rendering.
          minLength: 2
          maxLength: 16
    TemplateRef:
      type: object
      description: Reference to a template stored in Config Service.
      properties:
        namespace:
          type: string
          description: Namespace containing the template.
          minLength: 2
          maxLength: 128
        configName:
          type: string
          description: Name of the config entry for the template.
          minLength: 2
          maxLength: 128
        configCode:
          type: string
          description: Stable code for the template config.
          minLength: 2
          maxLength: 128
        version:
          type: string
          description: Version of the template config.
          minLength: 1
          maxLength: 64
    Config:
      type: object
      description: Config record that holds runtime behavior or template content.
      required:
        - tenantId
        - namespace
        - configName
        - configCode
        - version
        - status
      properties:
        tenantId:
          type: string
          description: Tenant identifier for this config.
          minLength: 2
          maxLength: 64
        namespace:
          type: string
          description: Namespace grouping related configs.
          minLength: 2
          maxLength: 128
        configName:
          type: string
          description: Human-friendly name of the config.
          minLength: 2
          maxLength: 128
        configCode:
          type: string
          description: Stable code identifier for the config.
          minLength: 2
          maxLength: 128
        version:
          type: string
          description: Version label for the config.
          minLength: 1
          maxLength: 64
        status:
          type: string
          description: Config lifecycle status.
          example: ACTIVE
          minLength: 2
          maxLength: 32
        environment:
          type: string
          description: Deployment environment for this config.
          example: prod
          minLength: 2
          maxLength: 32
        description:
          type: string
          description: Human-readable description of the config.
          minLength: 0
          maxLength: 1024
        content:
          type: object
          description: JSON content for the config.
          additionalProperties: true
        auditDetails:
          $ref: "#/components/schemas/AuditDetails"
    AuditDetails:
      type: object
      description: Audit metadata for the config record.
      properties:
        createdBy:
          type: string
          description: User ID of the creator.
          minLength: 1
          maxLength: 64
        createdTime:
          type: integer
          format: int64
          description: Epoch time when created.
        lastModifiedBy:
          type: string
          description: User ID of last modifier.
          minLength: 1
          maxLength: 64
        lastModifiedTime:
          type: integer
          format: int64
          description: Epoch time when last modified.
