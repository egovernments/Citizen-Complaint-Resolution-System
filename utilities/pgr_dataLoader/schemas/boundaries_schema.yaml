name: Boundaries Template
description: Schema for validating geographic boundary data

sheets:
  - name: Hierarchy_Definition
    description: Geographic hierarchy levels definition
    max_rows: 1
    columns:
      - name: City Code
        type: string
        required: true
        pattern: "^[a-z.]+$"
        reference:
          template: 0_Tenant_Template.xlsx
          sheet: Tenants
          column: Tenant Code

      - name: Hierarchy Type
        type: string
        required: true
        enum: [ADMIN, REVENUE]

      - name: Level 1
        type: string
        required: true
        description: Top level (e.g., City)

      - name: Level 2
        type: string
        required: false
        description: Second level (e.g., Zone)

      - name: Level 3
        type: string
        required: false
        description: Third level (e.g., Ward)

      - name: Level 4
        type: string
        required: false
        description: Fourth level (e.g., Block)

      - name: Level 5
        type: string
        required: false
        description: Fifth level (e.g., Locality)

  - name: Boundary_Entities
    description: Individual boundary entities with coordinates
    columns:
      - name: Tenant ID
        type: string
        required: true
        pattern: "^[a-z.]+$"

      - name: Boundary Code
        type: string
        required: true
        pattern: "^[A-Z0-9_]+$"
        description: Unique boundary identifier

      - name: Polygon Coordinates (JSON)
        type: json_array
        required: true
        description: JSON array of coordinates [[lon,lat],[lon,lat],...]

      - name: Description
        type: string
        required: false
        description: Optional description of the boundary

  - name: Boundary_Relationships
    description: Parent-child relationships between boundaries
    columns:
      - name: Tenant ID
        type: string
        required: true
        pattern: "^[a-z.]+$"

      - name: Boundary Code
        type: string
        required: true
        pattern: "^[A-Z0-9_]+$"
        reference:
          template: 4_Boundaries_Template.xlsx
          sheet: Boundary_Entities
          column: Boundary Code

      - name: Hierarchy Type
        type: string
        required: true
        enum: [ADMIN, REVENUE]

      - name: Boundary Type
        type: string
        required: true
        description: Level name from Hierarchy_Definition

      - name: Parent
        type: string
        required: false
        pattern: "^[A-Z0-9_]*$"
        reference:
          template: 4_Boundaries_Template.xlsx
          sheet: Boundary_Entities
          column: Boundary Code
        description: Parent boundary code (empty for top level)

validation_rules:
  - rule: unique_codes
    description: Boundary codes must be unique within Boundary_Entities
    sheet: Boundary_Entities
    columns: [Boundary Code]

  - rule: parent_child_integrity
    description: Parent codes must exist in Boundary_Entities
    sheet: Boundary_Relationships

  - rule: no_circular_references
    description: Boundary relationships should not create circular references
    sheet: Boundary_Relationships
