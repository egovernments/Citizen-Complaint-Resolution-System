name: PGR Master Data Unified Template
description: Unified schema for validating all PGR master data in a single workbook. Columns reference other tabs where appropriate.

sheets:
  - name: Tenants
    description: State and city information
    columns:
      - name: Tenant Code*
        type: string
        required: true
        pattern: '^[a-z]+(\.{1}[a-z]+)*$'
        description: Lowercase code; state or state.city (e.g., pg, pg.citya)

      - name: Tenant Name*
        type: string
        required: true
        min_length: 2
        max_length: 100

      - name: Tenant Type*
        type: string
        required: true
        enum: [State, CITY]

      - name: Email*
        type: email
        required: true
        pattern: "^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}$"

      - name: Contact Number
        type: string
        required: false
        pattern: "^[0-9-]+$"

      - name: Helpline Number
        type: string
        required: false
        pattern: "^[0-9-]+$"

      - name: Address
        type: string
        required: false
        min_length: 5

      - name: Domain URL*
        type: url
        required: true
        pattern: "^https?://.+"

      - name: Logo URL
        type: url
        required: false

      - name: Image ID*
        type: string
        required: true

      - name: Description
        type: string
        required: false

      - name: Twitter URL
        type: url
        required: false

      - name: Facebook URL
        type: url
        required: false

      - name: Office Timings Weekday*
        type: string
        required: true

      - name: Office Timings Saturday
        type: string
        required: false

      - name: Pincode (comma separated)
        type: string
        required: false
        pattern: "^[0-9,]+$"

      - name: City Code*
        type: integer
        required: true
        min_value: 1

      - name: City Name*
        type: string
        required: true

      - name: City ULB Grade*
        type: string
        required: true
        enum: [Municipal Corporation, Municipal Council, Nagar Panchayat]

      - name: City District Code*
        type: string
        required: true

      - name: City District Name*
        type: string
        required: true

      - name: City District Tenant Code*
        type: string
        required: true

      - name: City DDR Name*
        type: string
        required: true

      - name: City Latitude*
        type: float
        required: true
        min_value: -90
        max_value: 90

      - name: City Longitude*
        type: float
        required: true
        min_value: -180
        max_value: 180

      - name: City Region Name*
        type: string
        required: true

      - name: City Local Name*
        type: string
        required: true

      - name: City Shape File Location*
        type: string
        required: true

      - name: City Captcha*
        type: string
        required: true

  - name: City_Modules
    description: Module configuration for cities
    columns:
      - name: Module Code*
        type: string
        required: true
        enum: [PGR, HRMS, Workbench, TL, PT, WS, SW, FSM, BPA, OBPS]

      - name: Module Name*
        type: string
        required: true

      - name: Order*
        type: integer
        required: true
        min_value: 1

      - name: Enabled Tenant Codes*
        type: string
        required: true
        reference:
          template: SELF
          sheet: Tenants
          column: Tenant Code*
        description: Must match a Tenant Codes from Tenants tab

  - name: Departments
    description: Government departments that handle complaints
    columns:
      - name: Department Code*
        type: string
        required: true
        pattern: "^[A-Z0-9_]+$"

      - name: Department Name*
        type: string
        required: true
        min_length: 2
        max_length: 100

  - name: Designations
    description: Job titles and positions within departments
    columns:
      - name: Designation Code*
        type: string
        required: true
        pattern: "^[A-Z0-9_]+$"

      - name: Designation Name*
        type: string
        required: true
        min_length: 2
        max_length: 100

      - name: Department Code*
        type: string
        required: true
        reference:
          template: SELF
          sheet: Departments
          column: Department Code*
        description: Must match a Department Code from Departments tab


      - name: Description
        type: string
        required: false
        max_length: 500

  - name: ComplaintTypes
    description: Hierarchical complaint types with parent types and sub-types
    columns:
      - name: Complaint Type*
        type: string
        required: false
        pattern: "^[A-Za-z0-9_ ]+$"
        description: Parent complaint category (required for first row of each type, empty for sub-types)

      - name: " Complaint Type Code"
        type: string
        required: false
        pattern: "^[A-Za-z0-9_]+$"
        description: Code for parent category (required for first row of each type, empty for sub-types)

      - name: Complaint Sub Type*
        type: string
        required: true
        pattern: "^[A-Za-z0-9_ ]+$"
        description: Specific complaint sub-type name

      - name: Complaint Sub Type Code
        type: string
        required: false
        pattern: "^[A-Za-z0-9_]+$"
        description: Auto-generated service code - leave empty, system will create

      - name: Department Code*
        type: string
        required: false
        reference:
          template: SELF
          sheet: Departments
          column: Department Code*
        description: Must match a Department Code from Departments tab (required for first row of each type)

      - name: SLA Hours*
        type: float
        required: false
        min_value: 1
        description: Service level hours for resolution (required for first row of each type)

      - name: DescriptionKeywords (comma separated)*
        type: string
        required: false
        description: Comma-separated keywords for search (required for first row of each type)

      - name: Priority
        type: float
        required: false
        min_value: 1
        description: Priority level (optional)

  - name: Localization
    description: Auto-generated translations - Module and Locale determined by Code pattern
    columns:
      - name: Code
        type: string
        required: true
        description: Auto-generated code (SERVICEDFS.* = rainmaker-pgr, COMMON_MASTERS_* = rainmaker-common, TENANT_TENANTS_* = rainmaker-dss)

      - name: Message
        type: string
        required: true
        description: Display text for the code

validation_rules:
  - rule: unique_codes
    description: Tenant Code must be unique across all rows
    sheet: Tenants
    columns: [Tenant Code*]

  - rule: state_before_cities
    description: State tenant should be listed before city tenants
    sheet: Tenants

  - rule: city_codes_hierarchy
    description: City tenant codes should follow pattern state.city (e.g., pg.citya)
    sheet: Tenants

  - rule: unique_department_codes
    description: Department Code must be unique
    sheet: Departments
    columns: [Department Code*]

  - rule: unique_designation_codes
    description: Designation Code must be unique
    sheet: Designations
    columns: [Designation Code*]

  - rule: foreign_key_designation_department
    description: Designation.Department Code must exist in Departments.Department Code
    sheet: Designations
    column: Department Code*
    references:
      sheet: Departments
      column: Department Code*

  - rule: unique_localization_codes
    description: Localization Code must be unique
    sheet: Localization
    columns: [Code]

