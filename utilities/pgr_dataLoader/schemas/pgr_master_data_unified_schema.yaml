name: PGR Master Data Unified Template
description: Unified schema for validating all PGR master data in a single workbook. Columns reference other tabs where appropriate.

sheets:
  - name: Tenants
    description: State and city information
    columns:
      - name: Tenant Code
        type: string
        required: true
        pattern: '^[a-z]+(\.{1}[a-z]+)*$'
        description: Lowercase code; state or state.city (e.g., pg, pg.citya)

      - name: Tenant Name
        type: string
        required: true
        min_length: 2
        max_length: 100

      - name: Tenant Type
        type: string
        required: true
        enum: [State, CITY]

      - name: Email
        type: email
        required: true
        pattern: "^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}$"

      - name: Contact Number
        type: string
        required: true
        pattern: "^[0-9-]+$"

      - name: Helpline Number
        type: string
        required: false
        pattern: "^[0-9-]+$"

      - name: Address
        type: string
        required: true
        min_length: 5

      - name: Domain URL
        type: url
        required: true
        pattern: "^https?://.+"

      - name: Logo URL
        type: url
        required: true

      - name: Image ID
        type: string
        required: false

      - name: Description
        type: string
        required: false

      - name: Twitter URL
        type: url
        required: false

      - name: Facebook URL
        type: url
        required: false

      - name: Office Timings Weekday
        type: string
        required: true

      - name: Office Timings Saturday
        type: string
        required: false

      - name: Pincode (comma separated)
        type: string
        required: false
        pattern: "^[0-9,]+$"

      - name: City Code
        type: integer
        required: true
        min_value: 1

      - name: City Name
        type: string
        required: true

      - name: City ULB Grade
        type: string
        required: true
        enum: [Municipal Corporation, Municipal Council, Nagar Panchayat]

      - name: City District Code
        type: string
        required: false

      - name: City District Name
        type: string
        required: false

      - name: City District Tenant Code
        type: string
        required: true

      - name: City DDR Name
        type: string
        required: false

      - name: City Latitude
        type: float
        required: true
        min_value: -90
        max_value: 90

      - name: City Longitude
        type: float
        required: true
        min_value: -180
        max_value: 180

      - name: City Region Name
        type: string
        required: false

      - name: City Block Code
        type: string
        required: false

      - name: City Local Name
        type: string
        required: false

      - name: City Shape File Location
        type: string
        required: false

      - name: City Captcha
        type: string
        required: false

  - name: City_Modules
    description: Module configuration for cities
    columns:
      - name: Module Code
        type: string
        required: true
        enum: [PGR, HRMS, Workbench, TL, PT, WS, SW, FSM, BPA, OBPS]

      - name: Module Name
        type: string
        required: true

      - name: Order
        type: integer
        required: true
        min_value: 1

      - name: Enabled Tenant Codes
        type: string
        required: true
        reference:
          template: SELF
          sheet: Tenants
          column: Tenant Code
        description: Must match a Tenant Codes from Tenants tab

  - name: Departments
    description: Government departments that handle complaints
    columns:
      - name: Department Code
        type: string
        required: true
        pattern: "^[A-Z0-9_]+$"

      - name: Department Name
        type: string
        required: true
        min_length: 2
        max_length: 100

  - name: Designations
    description: Job titles and positions within departments
    columns:
      - name: Designation Code
        type: string
        required: true
        pattern: "^[A-Z0-9_]+$"

      - name: Designation Name
        type: string
        required: true
        min_length: 2
        max_length: 100

      - name: Department Code
        type: string
        required: true
        reference:
          template: SELF
          sheet: Departments
          column: Department Code
        description: Must match a Department Code from Departments tab


      - name: Description
        type: string
        required: false
        max_length: 500

  - name: ComplaintTypes
    description: complaint types handled by departments
    columns:
      - name: Complaint Name
        type: string
        required: true
        pattern: "^[A-Za-z0-9_ ]+$"

      - name: Service Code
        type: string
        required: true
        pattern: "^[A-Za-z0-9_]+$"
        min_length: 2
        max_length: 100

      - name: Category/Menu Path
        type: string
        required: true

      - name: Department Code
        type: string
        required: true
        reference:
          template: SELF
          sheet: Departments
          column: Department Code
        description: Must match a Department Code from Departments tab

      - name: SLA Hours
        type: string
        required: true
        pattern: "^[A-Z0-9_]+$"
      
      - name: DescriptionKeywords (comma separated)
        type: string
        required: false

      - name: Priority
        type: string
        required: true

  - name: Hierarchy_Definition
    description: Geographic hierarchy levels definition
    max_rows: 1
    columns:
      - name: City Code
        type: string
        required: true
        pattern: "^[a-z.]+$"
        reference:
          template: SELF
          sheet: Tenants
          column: Tenant Code
        description: Must match a Tenant Codes from Tenants tab

      - name: Hierarchy Type
        type: string
        required: true
        enum: [ADMIN, REVENUE]

      - name: Level 1
        type: string
        required: true
        description: Top level (e.g., City)

      - name: Level 2
        type: string
        required: false

      - name: Level 3
        type: string
        required: false

      - name: Level 4
        type: string
        required: false

      - name: Level 5
        type: string
        required: false

  - name: Boundary_Entities
    description: Individual boundary entities with coordinates
    columns:
      - name: Tenant ID
        type: string
        required: true
        reference:
          template: SELF
          sheet: Tenants
          column: Tenant Code
        description: Must match a Tenant Codes from Tenants tab

      - name: Boundary Code
        type: string
        required: true
        pattern: "^[A-Z0-9_]+$"
        description: Unique boundary identifier

      - name: Polygon Coordinates (JSON)
        type: json_array
        required: true
        description: JSON array of coordinates [[lon,lat],[lon,lat],...]

      - name: Description
        type: string
        required: false

  - name: Boundary_Relationships
    description: Parent-child relationships between boundaries
    columns:
      - name: Tenant ID
        type: string
        required: true
        reference:
          template: SELF
          sheet: Tenants
          column: Tenant Code
        description: Must match a Tenant Codes from Tenants tab

      - name: Boundary Code
        type: string
        required: true
        reference:
          template: SELF
          sheet: Boundary_Entities
          column: Boundary Code

      - name: Hierarchy Type
        type: string
        required: true
        reference:
          template: SELF
          sheet: Hierarchy_Definition
          column: Hierarchy Type

      - name: Boundary Type
        type: string
        required: true
        reference:
          template: SELF
          sheet: Hierarchy_Definition
          column: Level 1, Level 2, Level 3, Level 4, Level 5
        description: Must match one of the levels defined for the given Hierarchy Type

      - name: Parent
        type: string
        required: false
        reference:
          template: SELF
          sheet: Boundary_Entities
          column: Boundary Code
        description: Parent boundary code (empty for top level)

  - name: Localization
    description: Multi-language translations in wide format
    columns:
      - name: Module
        type: string
        required: true
        pattern: "^[a-z-]+$"

      - name: Code
        type: string
        required: true
        pattern: "^[A-Z_/]+$"


      - name: Message
        type: string
        required: true

      - name: Locale
        type: string
        required: true

validation_rules:
  - rule: unique_codes
    description: Tenant Code must be unique across all rows
    sheet: Tenants
    columns: [Tenant Code]

  - rule: state_before_cities
    description: State tenant should be listed before city tenants
    sheet: Tenants

  - rule: city_codes_hierarchy
    description: City tenant codes should follow pattern state.city (e.g., pg.citya)
    sheet: Tenants

  - rule: unique_department_codes
    description: Department Code must be unique
    sheet: Departments
    columns: [Department Code]

  - rule: unique_designation_codes
    description: Designation Code must be unique
    sheet: Designations
    columns: [Designation Code]

  - rule: foreign_key_designation_department
    description: Designation.Department Code must exist in Departments.Department Code
    sheet: Designations
    column: Department Code
    references:
      sheet: Departments
      column: Department Code

  - rule: unique_boundary_codes
    description: Boundary codes must be unique within Boundary_Entities
    sheet: Boundary_Entities
    columns: [Boundary Code]

  - rule: parent_child_integrity
    description: Parent codes must exist in Boundary_Entities
    sheet: Boundary_Relationships

  - rule: no_circular_references
    description: Boundary relationships should not create circular references
    sheet: Boundary_Relationships

  - rule: unique_localization_codes_per_module
    description: Localization Code must be unique within each Module
    sheet: Localization
    columns: [Code]

