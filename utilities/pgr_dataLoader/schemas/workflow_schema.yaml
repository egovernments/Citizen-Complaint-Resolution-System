name: Workflow Template
description: Schema for validating workflow configuration

sheets:
  - name: Workflow_States
    description: Workflow states for complaint processing
    columns:
      - name: State Code
        type: string
        required: true
        pattern: "^[A-Z_]+$"
        description: Uppercase state identifier (e.g., OPEN, ASSIGNED)

      - name: State Name
        type: string
        required: true
        min_length: 2
        max_length: 50
        description: Human-readable state name

      - name: Is Start State
        type: boolean
        required: true
        enum: [TRUE, FALSE, True, False, true, false]

      - name: Is End State
        type: boolean
        required: true
        enum: [TRUE, FALSE, True, False, true, false]

      - name: SLA Days
        type: integer
        required: false
        min_value: 0
        max_value: 365

  - name: Workflow_Actions
    description: Transitions between workflow states
    columns:
      - name: From State
        type: string
        required: true
        pattern: "^[A-Z_]+$"
        reference:
          template: 7_Workflow_Template.xlsx
          sheet: Workflow_States
          column: State Code

      - name: To State
        type: string
        required: true
        pattern: "^[A-Z_]+$"
        reference:
          template: 7_Workflow_Template.xlsx
          sheet: Workflow_States
          column: State Code

      - name: Action Name
        type: string
        required: true
        pattern: "^[A-Z_]+$"
        description: Action identifier (e.g., ASSIGN, RESOLVE)

      - name: Role Required
        type: string
        required: true
        pattern: "^[A-Z_,\\s]+$"
        description: Role(s) that can perform this action

      - name: Comment Required
        type: boolean
        required: true
        enum: [TRUE, FALSE, True, False, true, false]

validation_rules:
  - rule: unique_state_codes
    description: State codes must be unique
    sheet: Workflow_States
    columns: [State Code]

  - rule: single_start_state
    description: Only one state should have Is Start State = TRUE
    sheet: Workflow_States

  - rule: at_least_one_end_state
    description: At least one state should have Is End State = TRUE
    sheet: Workflow_States

  - rule: valid_state_references
    description: From State and To State must reference existing states
    sheet: Workflow_Actions
